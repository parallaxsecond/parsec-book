<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Package management and versioning guide - The Parsec Book</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../overview.html"><strong aria-hidden="true">2.</strong> Overview</a></li><li class="chapter-item expanded "><a href="../getting_started/index.html"><strong aria-hidden="true">3.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../getting_started/linux_x86.html"><strong aria-hidden="true">3.1.</strong> Quickstart for Linux on x86</a></li><li class="chapter-item expanded "><a href="../getting_started/opensuse.html"><strong aria-hidden="true">3.2.</strong> Quickstart for openSUSE and SUSE</a></li><li class="chapter-item expanded "><a href="../getting_started/docker.html"><strong aria-hidden="true">3.3.</strong> Quickstart using a Docker container</a></li><li class="chapter-item expanded "><a href="../getting_started/installation_options.html"><strong aria-hidden="true">3.4.</strong> Installation Guide</a></li><li class="chapter-item expanded "><a href="../getting_started/parsec_tool_use.html"><strong aria-hidden="true">3.5.</strong> Parsec Tool Guide</a></li></ol></li><li class="chapter-item expanded "><a href="../parsec_users.html"><strong aria-hidden="true">4.</strong> Parsec for users</a></li><li class="chapter-item expanded "><a href="../parsec_client/index.html"><strong aria-hidden="true">5.</strong> Parsec for client developers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../parsec_client/api_overview.html"><strong aria-hidden="true">5.1.</strong> API Overview</a></li><li class="chapter-item expanded "><a href="../parsec_client/wire_protocol.html"><strong aria-hidden="true">5.2.</strong> Wire Protocol</a></li><li class="chapter-item expanded "><a href="../parsec_client/status_codes.html"><strong aria-hidden="true">5.3.</strong> Status Codes</a></li><li class="chapter-item expanded "><a href="../parsec_client/writing_library.html"><strong aria-hidden="true">5.4.</strong> Writing a new Parsec Client Library</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/index.html"><strong aria-hidden="true">5.5.</strong> Operations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../parsec_client/operations/service_api_coverage.html"><strong aria-hidden="true">5.5.1.</strong> Parsec Operations Coverage</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_key_attributes.html"><strong aria-hidden="true">5.5.2.</strong> PSA Key Attributes</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_algorithm.html"><strong aria-hidden="true">5.5.3.</strong> PSA Algorithm</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/ping.html"><strong aria-hidden="true">5.5.4.</strong> Ping</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_generate_key.html"><strong aria-hidden="true">5.5.5.</strong> PsaGenerateKey</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_destroy_key.html"><strong aria-hidden="true">5.5.6.</strong> PsaDestroyKey</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_sign_hash.html"><strong aria-hidden="true">5.5.7.</strong> PsaSignHash</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_verify_hash.html"><strong aria-hidden="true">5.5.8.</strong> PsaVerifyHash</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_import_key.html"><strong aria-hidden="true">5.5.9.</strong> PsaImportKey</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_export_public_key.html"><strong aria-hidden="true">5.5.10.</strong> PsaExportPublicKey</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/list_providers.html"><strong aria-hidden="true">5.5.11.</strong> ListProviders</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/list_opcodes.html"><strong aria-hidden="true">5.5.12.</strong> ListOpcodes</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_asymmetric_encrypt.html"><strong aria-hidden="true">5.5.13.</strong> PsaAsymmetricEncrypt</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_asymmetric_decrypt.html"><strong aria-hidden="true">5.5.14.</strong> PsaAsymmetricDecrypt</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_export_key.html"><strong aria-hidden="true">5.5.15.</strong> PsaExportKey</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_generate_random.html"><strong aria-hidden="true">5.5.16.</strong> PsaGenerateRandom</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/list_authenticators.html"><strong aria-hidden="true">5.5.17.</strong> ListAuthenticators</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_hash_compute.html"><strong aria-hidden="true">5.5.18.</strong> PsaHashCompute</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_hash_compare.html"><strong aria-hidden="true">5.5.19.</strong> PsaHashCompare</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_aead_encrypt.html"><strong aria-hidden="true">5.5.20.</strong> PsaAeadEncrypt</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_aead_decrypt.html"><strong aria-hidden="true">5.5.21.</strong> PsaAeadDecrypt</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_raw_key_agreement.html"><strong aria-hidden="true">5.5.22.</strong> PsaRawKeyAgreement</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_cipher_encrypt.html"><strong aria-hidden="true">5.5.23.</strong> PsaCipherEncrypt</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_cipher_decrypt.html"><strong aria-hidden="true">5.5.24.</strong> PsaCipherDecrypt</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_mac_compute.html"><strong aria-hidden="true">5.5.25.</strong> PsaMacCompute</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_mac_verify.html"><strong aria-hidden="true">5.5.26.</strong> PsaMacVerify</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_sign_message.html"><strong aria-hidden="true">5.5.27.</strong> PsaSignMessage</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/psa_verify_message.html"><strong aria-hidden="true">5.5.28.</strong> PsaVerifyMessage</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/list_keys.html"><strong aria-hidden="true">5.5.29.</strong> ListKeys</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/list_clients.html"><strong aria-hidden="true">5.5.30.</strong> ListClients</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/delete_client.html"><strong aria-hidden="true">5.5.31.</strong> DeleteClient</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/prepare_key_attestation_params.html"><strong aria-hidden="true">5.5.32.</strong> Prepare Key Attestation Parameters</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/prepare_key_attestation.html"><strong aria-hidden="true">5.5.33.</strong> PrepareKeyAttestation</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/attest_key.html"><strong aria-hidden="true">5.5.34.</strong> AttestKey</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/attest_key_params.html"><strong aria-hidden="true">5.5.35.</strong> Attest Key Parameters</a></li><li class="chapter-item expanded "><a href="../parsec_client/operations/can_do_crypto.html"><strong aria-hidden="true">5.5.36.</strong> CanDoCrypto</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../parsec_service/index.html"><strong aria-hidden="true">6.</strong> Parsec for service developers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../parsec_service/interfaces_and_dataflow.html"><strong aria-hidden="true">6.1.</strong> Interfaces and Dataflow</a></li><li class="chapter-item expanded "><a href="../parsec_service/source_code_structure.html"><strong aria-hidden="true">6.2.</strong> Source Code Structure</a></li><li class="chapter-item expanded "><a href="../parsec_service/listeners.html"><strong aria-hidden="true">6.3.</strong> Listeners</a></li><li class="chapter-item expanded "><a href="../parsec_service/authenticators.html"><strong aria-hidden="true">6.4.</strong> Authenticators</a></li><li class="chapter-item expanded "><a href="../parsec_service/converters.html"><strong aria-hidden="true">6.5.</strong> Converters</a></li><li class="chapter-item expanded "><a href="../parsec_service/providers.html"><strong aria-hidden="true">6.6.</strong> Providers</a></li><li class="chapter-item expanded "><a href="../parsec_service/key_info_managers.html"><strong aria-hidden="true">6.7.</strong> Key Info Managers</a></li><li class="chapter-item expanded "><a href="../parsec_service/adding_provider.html"><strong aria-hidden="true">6.8.</strong> Adding a new Parsec Provider</a></li><li class="chapter-item expanded "><a href="../parsec_service/build_run.html"><strong aria-hidden="true">6.9.</strong> How to build and run Parsec</a></li><li class="chapter-item expanded "><a href="../parsec_service/install_parsec_linux.html"><strong aria-hidden="true">6.10.</strong> How to securely install Parsec on Linux</a></li><li class="chapter-item expanded "><a href="../parsec_service/configuration.html"><strong aria-hidden="true">6.11.</strong> Parsec Configuration</a></li><li class="chapter-item expanded "><a href="../parsec_service/tests/index.html"><strong aria-hidden="true">6.12.</strong> How to test Parsec</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../parsec_service/tests/existing_tests.html"><strong aria-hidden="true">6.12.1.</strong> List of existing tests</a></li></ol></li><li class="chapter-item expanded "><a href="../parsec_service/stability.html"><strong aria-hidden="true">6.13.</strong> Parsec Stability</a></li></ol></li><li class="chapter-item expanded "><a href="../parsec_security/index.html"><strong aria-hidden="true">7.</strong> Parsec Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../parsec_security/parsec_threat_model/threat_model.html"><strong aria-hidden="true">7.1.</strong> Parsec Threat Model</a></li><li class="chapter-item expanded "><a href="../parsec_security/secure_deployment.html"><strong aria-hidden="true">7.2.</strong> Recommendations for Secure Deployment</a></li><li class="chapter-item expanded "><a href="../parsec_security/rust_client_threat_model/threat_model.html"><strong aria-hidden="true">7.3.</strong> Parsec Rust Client Threat Model</a></li></ol></li><li class="chapter-item expanded "><a href="../contributing/index.html"><strong aria-hidden="true">8.</strong> Contributing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../contributing/pr_checklist.html"><strong aria-hidden="true">8.1.</strong> Pull request checklist</a></li><li class="chapter-item expanded "><a href="../contributing/adding_new_operation_how_to.html"><strong aria-hidden="true">8.2.</strong> How to add operations to Parsec</a></li><li class="chapter-item expanded "><a href="../contributing/package_management.html" class="active"><strong aria-hidden="true">8.3.</strong> Package management and versioning guide</a></li><li class="chapter-item expanded "><a href="../contributing/release_process.html"><strong aria-hidden="true">8.4.</strong> The Parsec Release Process</a></li><li class="chapter-item expanded "><a href="../contributing/release_checklist.html"><strong aria-hidden="true">8.5.</strong> The Parsec Release Checklist</a></li></ol></li><li class="chapter-item expanded "><a href="../archive/index.html"><strong aria-hidden="true">9.</strong> Archive</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../archive/system_architecture.html"><strong aria-hidden="true">9.1.</strong> System Architecture</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Parsec Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="package-management-and-versioning-guide"><a class="header" href="#package-management-and-versioning-guide">Package management and versioning guide</a></h1>
<p>This page presents the details around packaging management and versioning for Parsec-related
repositories. Currently our repos are mainly Rust crates, so this guide is accordingly geared
towards them - when other guidelines become relevant, e.g. specific to Go libraries, new sections
should be added below.</p>
<p>The following points are relevant to all software we publish to package management repositories:</p>
<ul>
<li>For published versions of a project a tag carrying the version number should be upstreamed to
GitHub, e.g. if version 2.3.1 was published, a tag named &quot;2.3.1&quot; must be added to the commit in
GitHub.</li>
<li>If multiple projects that end up in a package manager reside in the same repo, the tags should
reflect both the project and the version number, e.g. if version 2.3.1 of project X was
published, a tag named &quot;X-2.3.1&quot; or similar must be used.</li>
<li>Projects should follow <a href="https://semver.org/">Semantic Versioning</a> rules.</li>
<li>Following the release of a new version of publicly-facing projects, update the <code>CHANGELOG.md</code>
file. For some projects it's also advised to create a GitHub Release from the tag mentioned
above.</li>
</ul>
<h2 id="rust-crates"><a class="header" href="#rust-crates">Rust crates</a></h2>
<p>The process around publishing Rust crates is tightly linked with crates.io. In order to publish or
have control over crates, you must own an account on the website. Before you decide whether you want
to publish a crate, check out the <a href="#dependency-management">Dependency management</a> section below.</p>
<ul>
<li>Follow the instructions <a href="https://doc.rust-lang.org/cargo/reference/publishing.html">here</a> to
create your account and to set your workspace up.</li>
<li>If you'd like to publish a new version of an existing crate using the ownership granted to the
Parallaxsecond Admin group, you need to enable crates.io to access that organization. You can do
so from the <a href="https://github.com/settings/applications">applications page</a> in your account
settings - in the <a href="https://github.com/settings/connections/applications/9fe8110dfe185fe90b5c">crates.io
application</a> settings
you must request permission for the parallaxsecond org to be linked. One of the org owners must
approve that request.</li>
<li>Alternatively, if you'd like to publish a new version but are not part of the Admin group, you can
request to become an owner of the crate from one of the admins.</li>
</ul>
<p>Once you are able to publish crates you can start doing so, but being aware of the following facts
is helpful.</p>
<ul>
<li>Once you have settled on a crate to upstream, make sure you are on the most recent version of the
main branch (e.g. <code>master</code>) - you should have no uncommited changes lingering.</li>
<li>Run a <code>git submodule update --init --recursive</code> to make sure that any submodules are up to date
and checked out locally, as they will be included in the crate.</li>
<li>Run a <code>cargo publish --dry-run</code> - this ensures that the publishing process is possible with the
current state of the repo.</li>
<li>Change the version number of the crate in <code>Cargo.toml</code> following semantic versioning rules.</li>
<li>If any other (small) changes must be made, such as updating a dependency, you can also add them in
this commit. No specific limit is given to &quot;small&quot;, but if the dependency update includes changes
to an API or to how some internal components work, then a separate pull request is needed.</li>
<li>Commit the previous changes and either upstream them directly to the main branch or create a pull
request.</li>
<li>Once the version change is on the main branch, run another dry-run publishing, followed by the
real operation. Once that is complete, tag the latest commit and upstream the tag.</li>
<li>Repeat these steps for every crate along the way in the dependency tree.</li>
<li>If the crate you are publishing is new or has major changes in its build steps, its documentation
might not be built properly by docs.rs. This is because docs.rs has its own build system where
crates are built in complete isolation from the internet and with a set of dependencies that
might not cover the ones you require. Check out their documentation
<a href="https://docs.rs/about/builds">here</a>. If you want to be extra-careful and sure that your
documentation will build successfully, you can set up a local <code>docs.rs</code> and attempt to build your
crate. You can find the instructions
<a href="https://github.com/rust-lang/docs.rs#getting-started">here</a>. Follow them up to setting up the
external services, then run the command for building a local crate from
<a href="https://github.com/rust-lang/docs.rs#build-subcommand">here</a>. Be advised that setting up the
docs.rs build locally requires 10 GiB of disk space (or more) and is quite slow the first time
around, but caching helps with subsequent builds. It is therefore not recommended for CI runs,
though manually triggered builds might be ok. Also be advised that even if the build fails, the
command itself will <strong>not</strong> fail - instead, you have to either visually check that the crate was
built successfully, or to look for a string marking a successful build, e.g. <code>cargo run -- build crate tss-esapi-sys 0.1.1 2&gt;&amp;1 &gt;/dev/null | grep &quot;[INFO] rustwide::cmd: [stderr] Finished dev&quot;</code>.</li>
</ul>
<h3 id="dependency-management"><a class="header" href="#dependency-management">Dependency management</a></h3>
<p>Producing a release of the Parsec service requires some understanding of the way in which all the
components, and especially the various crates found under the Parallaxsecond organization, relate to
each other. You can find some details of the code structure
<a href="../parsec_service/source_code_structure.html">here</a>. A detailed list of direct dependencies to
Parallaxsecond crates that can be found on crates.io is given below.</p>
<p><code>parsec-service</code> dependencies:</p>
<ul>
<li><code>parsec-interface</code>: used for managing IPC communication</li>
<li><code>psa-crypto</code>: used in the Mbed Crypto provider as the interface to a PSA Crypto implementation,
and in the Cryptoki crate for conversions between the two standards</li>
<li><code>cryptoki</code>: used in the PKCS11 provider as the interface to PKCS11 libraries</li>
<li><code>tss-esapi</code>: used in the TPM provider as the interface to the TSS stack</li>
<li><code>parsec-client</code>: <strong>NOT</strong> used in the service, but as a dependency for the test client</li>
</ul>
<p><code>parsec-interface</code> dependencies:</p>
<ul>
<li><code>psa-crypto</code>: used to represent the Rust-native PSA Crypto data types</li>
</ul>
<p><code>parsec-client</code> dependencies:</p>
<ul>
<li><code>parsec-interface</code>: used for managing IPC communication</li>
</ul>
<p><code>parsec-tool</code> dependencies:</p>
<ul>
<li><code>parsec-client</code>: used to handle all communication with the service</li>
</ul>
<p>Publishing new versions of dependencies is not always required. If you're not planning to
immediately publish some crate, then you don't <em>need</em> to publish any of its dependencies, you can
simply import updates, using the
<a href="https://doc.rust-lang.org/cargo/reference/specifying-dependencies.html#specifying-dependencies-from-git-repositories"><code>git</code></a>
syntax, as transient dependencies in <code>Cargo.toml</code>. By doing so, however, you're removing the option
of publishing to crates.io until all those <code>git</code> dependencies are removed. Because of this issue we
suggest adding transient dependencies to crates not residing under the Parallaxsecond organization
only when a published version of the third party crate is due soon. This is to limit the likelihood
of an urgent release of Parsec being stalled behind a third-party release cycle. If you're unsure
about or would want to discuss such an approach, we welcome discussions and proposals in our
community channels!</p>
<h3 id="docker-images"><a class="header" href="#docker-images">Docker images</a></h3>
<p>End-to-end testing for the Parsec service (and for some of the other projects under the
Parallaxsecond organization) is built on top of Docker images. These images are required because of
the multitude of dependencies needed, generally for connecting to various backends through 3rd party
libraries. The Docker images separate the process of setting up this environment from the actual
running of tests, allowing very short CI runs.</p>
<p>Our Docker images are stored as <a href="https://github.com/orgs/parallaxsecond/packages">packages</a> within
the <a href="https://docs.github.com/en/packages/guides/container-guides-for-github-packages">Github Container
Registry</a>. The ones
used for the service have <a href="https://github.com/parallaxsecond/parsec/tree/main/e2e_tests/docker_image">their own
folder</a>.</p>
<p>The process for updating an existing image (or indeed creating a new one) goes as follows:</p>
<ul>
<li>Figure out if what you need should be included in a Docker image. Anything that is sure to be
common between builds should be included: compilers, toolchains, libraries...</li>
<li>Modify or create a new Docker image. This involves not just the development side, but also
building the image and testing locally that your expected flow works correctly.</li>
<li>Modify any CI-related files to set up workflows to build the image and to perform any new actions
with it (if necessary). You should also include changes to the rest of the code-base that
produced the need for the image change.</li>
<li>Create a PR with your changes. This allows other reviewers to provide feedback on the image
definition before it is published. Once the changes are approved you can continue to the next
step.</li>
<li>Build the image with the correct tag: for images stored in Github Container Registry, the tag
should be <code>ghcr.io/parallaxsecond/&lt;your-image-name&gt;:latest</code>.</li>
<li>Create a Github Personal Access Token for publishing the image, as described
<a href="https://docs.github.com/en/packages/guides/pushing-and-pulling-docker-images">here</a>. Follow the
steps on the page to then publish your image.</li>
<li>If this is a new image being published, after the upload succeeds, follow the steps
<a href="https://docs.github.com/en/packages/guides/configuring-access-control-and-visibility-for-container-images#configuring-access-to-container-images-for-an-organization">here</a>
to allow the <code>parallaxsecond/admin</code> group admin access to the image. If you are using the image
in CI builds, you will also need to <a href="https://docs.github.com/en/packages/guides/configuring-access-control-and-visibility-for-container-images#configuring-visibility-of-container-images-for-an-organization">make it
public</a>.</li>
<li>Change the workflows to use the published image and update the PR.</li>
</ul>
<p><em>Copyright 2021 Contributors to the Parsec project.</em></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../contributing/adding_new_operation_how_to.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../contributing/release_process.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../contributing/adding_new_operation_how_to.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../contributing/release_process.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
