<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Parsec Threat Model - The Parsec Book</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../../overview.html"><strong aria-hidden="true">2.</strong> Overview</a></li><li class="chapter-item expanded "><a href="../../getting_started/index.html"><strong aria-hidden="true">3.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../getting_started/linux_x86.html"><strong aria-hidden="true">3.1.</strong> Quickstart for Linux on x86</a></li><li class="chapter-item expanded "><a href="../../getting_started/opensuse.html"><strong aria-hidden="true">3.2.</strong> Quickstart for openSUSE and SUSE</a></li><li class="chapter-item expanded "><a href="../../getting_started/docker.html"><strong aria-hidden="true">3.3.</strong> Quickstart using a Docker container</a></li><li class="chapter-item expanded "><a href="../../getting_started/installation_options.html"><strong aria-hidden="true">3.4.</strong> Installation Guide</a></li><li class="chapter-item expanded "><a href="../../getting_started/parsec_tool_use.html"><strong aria-hidden="true">3.5.</strong> Parsec Tool Guide</a></li></ol></li><li class="chapter-item expanded "><a href="../../parsec_users.html"><strong aria-hidden="true">4.</strong> Parsec for users</a></li><li class="chapter-item expanded "><a href="../../parsec_client/index.html"><strong aria-hidden="true">5.</strong> Parsec for client developers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../parsec_client/api_overview.html"><strong aria-hidden="true">5.1.</strong> API Overview</a></li><li class="chapter-item expanded "><a href="../../parsec_client/wire_protocol.html"><strong aria-hidden="true">5.2.</strong> Wire Protocol</a></li><li class="chapter-item expanded "><a href="../../parsec_client/status_codes.html"><strong aria-hidden="true">5.3.</strong> Status Codes</a></li><li class="chapter-item expanded "><a href="../../parsec_client/writing_library.html"><strong aria-hidden="true">5.4.</strong> Writing a new Parsec Client Library</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/index.html"><strong aria-hidden="true">5.5.</strong> Operations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../parsec_client/operations/service_api_coverage.html"><strong aria-hidden="true">5.5.1.</strong> Parsec Operations Coverage</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_key_attributes.html"><strong aria-hidden="true">5.5.2.</strong> PSA Key Attributes</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_algorithm.html"><strong aria-hidden="true">5.5.3.</strong> PSA Algorithm</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/ping.html"><strong aria-hidden="true">5.5.4.</strong> Ping</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_generate_key.html"><strong aria-hidden="true">5.5.5.</strong> PsaGenerateKey</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_destroy_key.html"><strong aria-hidden="true">5.5.6.</strong> PsaDestroyKey</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_sign_hash.html"><strong aria-hidden="true">5.5.7.</strong> PsaSignHash</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_verify_hash.html"><strong aria-hidden="true">5.5.8.</strong> PsaVerifyHash</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_import_key.html"><strong aria-hidden="true">5.5.9.</strong> PsaImportKey</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_export_public_key.html"><strong aria-hidden="true">5.5.10.</strong> PsaExportPublicKey</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/list_providers.html"><strong aria-hidden="true">5.5.11.</strong> ListProviders</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/list_opcodes.html"><strong aria-hidden="true">5.5.12.</strong> ListOpcodes</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_asymmetric_encrypt.html"><strong aria-hidden="true">5.5.13.</strong> PsaAsymmetricEncrypt</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_asymmetric_decrypt.html"><strong aria-hidden="true">5.5.14.</strong> PsaAsymmetricDecrypt</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_export_key.html"><strong aria-hidden="true">5.5.15.</strong> PsaExportKey</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_generate_random.html"><strong aria-hidden="true">5.5.16.</strong> PsaGenerateRandom</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/list_authenticators.html"><strong aria-hidden="true">5.5.17.</strong> ListAuthenticators</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_hash_compute.html"><strong aria-hidden="true">5.5.18.</strong> PsaHashCompute</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_hash_compare.html"><strong aria-hidden="true">5.5.19.</strong> PsaHashCompare</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_aead_encrypt.html"><strong aria-hidden="true">5.5.20.</strong> PsaAeadEncrypt</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_aead_decrypt.html"><strong aria-hidden="true">5.5.21.</strong> PsaAeadDecrypt</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_raw_key_agreement.html"><strong aria-hidden="true">5.5.22.</strong> PsaRawKeyAgreement</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_cipher_encrypt.html"><strong aria-hidden="true">5.5.23.</strong> PsaCipherEncrypt</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_cipher_decrypt.html"><strong aria-hidden="true">5.5.24.</strong> PsaCipherDecrypt</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_mac_compute.html"><strong aria-hidden="true">5.5.25.</strong> PsaMacCompute</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_mac_verify.html"><strong aria-hidden="true">5.5.26.</strong> PsaMacVerify</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_sign_message.html"><strong aria-hidden="true">5.5.27.</strong> PsaSignMessage</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/psa_verify_message.html"><strong aria-hidden="true">5.5.28.</strong> PsaVerifyMessage</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/list_keys.html"><strong aria-hidden="true">5.5.29.</strong> ListKeys</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/list_clients.html"><strong aria-hidden="true">5.5.30.</strong> ListClients</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/delete_client.html"><strong aria-hidden="true">5.5.31.</strong> DeleteClient</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/prepare_key_attestation_params.html"><strong aria-hidden="true">5.5.32.</strong> Prepare Key Attestation Parameters</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/prepare_key_attestation.html"><strong aria-hidden="true">5.5.33.</strong> PrepareKeyAttestation</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/attest_key.html"><strong aria-hidden="true">5.5.34.</strong> AttestKey</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/attest_key_params.html"><strong aria-hidden="true">5.5.35.</strong> Attest Key Parameters</a></li><li class="chapter-item expanded "><a href="../../parsec_client/operations/can_do_crypto.html"><strong aria-hidden="true">5.5.36.</strong> CanDoCrypto</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../parsec_service/index.html"><strong aria-hidden="true">6.</strong> Parsec for service developers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../parsec_service/interfaces_and_dataflow.html"><strong aria-hidden="true">6.1.</strong> Interfaces and Dataflow</a></li><li class="chapter-item expanded "><a href="../../parsec_service/source_code_structure.html"><strong aria-hidden="true">6.2.</strong> Source Code Structure</a></li><li class="chapter-item expanded "><a href="../../parsec_service/listeners.html"><strong aria-hidden="true">6.3.</strong> Listeners</a></li><li class="chapter-item expanded "><a href="../../parsec_service/authenticators.html"><strong aria-hidden="true">6.4.</strong> Authenticators</a></li><li class="chapter-item expanded "><a href="../../parsec_service/converters.html"><strong aria-hidden="true">6.5.</strong> Converters</a></li><li class="chapter-item expanded "><a href="../../parsec_service/providers.html"><strong aria-hidden="true">6.6.</strong> Providers</a></li><li class="chapter-item expanded "><a href="../../parsec_service/key_info_managers.html"><strong aria-hidden="true">6.7.</strong> Key Info Managers</a></li><li class="chapter-item expanded "><a href="../../parsec_service/adding_provider.html"><strong aria-hidden="true">6.8.</strong> Adding a new Parsec Provider</a></li><li class="chapter-item expanded "><a href="../../parsec_service/build_run.html"><strong aria-hidden="true">6.9.</strong> How to build and run Parsec</a></li><li class="chapter-item expanded "><a href="../../parsec_service/install_parsec_linux.html"><strong aria-hidden="true">6.10.</strong> How to securely install Parsec on Linux</a></li><li class="chapter-item expanded "><a href="../../parsec_service/configuration.html"><strong aria-hidden="true">6.11.</strong> Parsec Configuration</a></li><li class="chapter-item expanded "><a href="../../parsec_service/tests/index.html"><strong aria-hidden="true">6.12.</strong> How to test Parsec</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../parsec_service/tests/existing_tests.html"><strong aria-hidden="true">6.12.1.</strong> List of existing tests</a></li></ol></li><li class="chapter-item expanded "><a href="../../parsec_service/stability.html"><strong aria-hidden="true">6.13.</strong> Parsec Stability</a></li></ol></li><li class="chapter-item expanded "><a href="../../parsec_security/index.html"><strong aria-hidden="true">7.</strong> Parsec Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../parsec_security/parsec_threat_model/threat_model.html" class="active"><strong aria-hidden="true">7.1.</strong> Parsec Threat Model</a></li><li class="chapter-item expanded "><a href="../../parsec_security/secure_deployment.html"><strong aria-hidden="true">7.2.</strong> Recommendations for Secure Deployment</a></li><li class="chapter-item expanded "><a href="../../parsec_security/rust_client_threat_model/threat_model.html"><strong aria-hidden="true">7.3.</strong> Parsec Rust Client Threat Model</a></li></ol></li><li class="chapter-item expanded "><a href="../../contributing/index.html"><strong aria-hidden="true">8.</strong> Contributing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../contributing/pr_checklist.html"><strong aria-hidden="true">8.1.</strong> Pull request checklist</a></li><li class="chapter-item expanded "><a href="../../contributing/adding_new_operation_how_to.html"><strong aria-hidden="true">8.2.</strong> How to add operations to Parsec</a></li><li class="chapter-item expanded "><a href="../../contributing/package_management.html"><strong aria-hidden="true">8.3.</strong> Package management and versioning guide</a></li><li class="chapter-item expanded "><a href="../../contributing/release_process.html"><strong aria-hidden="true">8.4.</strong> The Parsec Release Process</a></li><li class="chapter-item expanded "><a href="../../contributing/release_checklist.html"><strong aria-hidden="true">8.5.</strong> The Parsec Release Checklist</a></li></ol></li><li class="chapter-item expanded "><a href="../../archive/index.html"><strong aria-hidden="true">9.</strong> Archive</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../archive/system_architecture.html"><strong aria-hidden="true">9.1.</strong> System Architecture</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Parsec Book</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="parsec-threat-model"><a class="header" href="#parsec-threat-model">Parsec Threat Model</a></h1>
<p>This document presents the generic Parsec Threat Model in a multi-tenant environment with an
Identity Provider, as envisaged in the <a href="../../archive/system_architecture.html#participating-components-and-their-roles">System
Architecture</a> page.</p>
<p>Parsec could also be deployed in different configurations with other types of authentication in
place and thus with other requirements for the host environment. The other configurations that have
been considered by the Parsec team are listed below.</p>
<ul>
<li>(GNRC) Generic deployment model with Identity Provider</li>
<li>(DSPC) Unix Domain Socket Peer Credential authentication model - the operating system acts as a
substitute identity provider</li>
<li>(DRCT) Direct authentication with mutually trusted clients - no identity provider</li>
<li>(JWTS) JWT SPIFFE Verifiable Identity Document authentication - the SPIFFE implementation acts as
an identity provider for clients but it is also used by the service to verify the identities (the
JWT-SVID tokens)</li>
</ul>
<p>Items in the following sections may be marked as "applicable to a subset of configurations". Such
markings will <strong>always</strong> be written in <em>italic</em> and can take two forms:</p>
<ul>
<li>Short form - e.g. <em>(GNRC, DSPC)</em> , meaning the item at hand is only applicable to the (GNRC) and
(DSPC) deployment models. Can also be reductive - <em>(not GNRC)</em>, meaning the item does not apply
to the (GNRC) deployment model.</li>
<li>Long form - e.g. <em>Not applicable for deployment (GNRC)</em></li>
</ul>
<h2 id="dataflow-diagram"><a class="header" href="#dataflow-diagram">Dataflow Diagram</a></h2>
<p><img src="diagrams/dataflow_diagram.png" alt="Dataflow Diagram" /></p>
<h2 id="assumptions"><a class="header" href="#assumptions">Assumptions</a></h2>
<p>Basic requirements based on which the service can operate securely. Mitigations can be implemented
to make the system more resilient, but if some of these assumptions are not met, the security stance
of the service cannot be guaranteed.</p>
<ol>
<li>The hardware modules are physically and functionally secure. Only trusted agents can physically
access the system.</li>
<li>The service is configured and started by a trusted administrator.</li>
<li>The OS can be trusted to enforce access-control over critical resources (configuration file, key
info mappings, communication socket, etc.) and inter-process communication mechanisms. System
calls are also trusted to execute correctly.</li>
<li>Users with privilege rights are trusted to exercise them in a non-malicious way.</li>
<li><em>(GNRC, JWTS)</em> The authentication tokens are stored with confidentiality by the clients.</li>
<li><em>(GNRC)</em> There is a trusted Identity Provider available.</li>
</ol>
<h2 id="assets"><a class="header" href="#assets">Assets</a></h2>
<p>What we want to protect. Each one of these has a combination of security properties:
Confidentiality, Integrity and Availability. The assets are labelled so that it can be seen in the
threat tables below which ones are impacted by each threat.</p>
<h3 id="authentication-token---as1"><a class="header" href="#authentication-token---as1">Authentication Token - AS1</a></h3>
<p>The Client Library gets its Authentication Token from the Identity Provider. It is signed by the
IP's private key and sent by the Client Library on each request. Parsec verifies the Authentication
Token using the IP's public key.</p>
<p><strong>Confidentiality</strong> : if known (the authentication token), an attacker could impersonate a specific
application and execute operations in their name. The admin application authentication token is
especially sensitive as if it is stolen by an attacker, they can then have access to operations
impacting all clients such as <code>DeleteClient</code>.</p>
<p><em>(JWTS)</em>: the JWT-SVID tokens share the same Confidentiality property although the verification
happens remotely in the SPIFFE implementation.</p>
<p><em>Not applicable for deployment (DSPC). The OS is trusted to enforce separation between users and to
provide correct peer credential information that the service will then rely upon for access
control.</em></p>
<p><em>Not applicable for deployment (DRCT). Clients are assumed to be mutually trusted and given that we
trust the OS to enforce access control on the service endpoint, there's no concern around the
confidentiality of client identity tokens.</em></p>
<h3 id="identity-provider-public-key--as2"><a class="header" href="#identity-provider-public-key--as2">Identity Provider Public Key- AS2</a></h3>
<p>The IP's public certificate is sent to the service periodically. It is used by the service to verify
the authentication tokens.</p>
<p><strong>Integrity</strong> : if sent by a malicious IP, attackers could then sign their own application
identities and Parsec will verify them successfully. If they know the Authentication Token of
clients, they can impersonate them.</p>
<p><strong>Availability</strong> : Parsec needs it in order to execute a request.</p>
<p><em>Not applicable for deployments (DSPC, DRCT, JWTS).</em></p>
<h3 id="private-keys--as3"><a class="header" href="#private-keys--as3">Private Keys- AS3</a></h3>
<p>Private keys created by Parsec on behalf of its clients. They should be stored on hardware and never
be extractable.</p>
<p><strong>Confidentiality, Integrity and Availability</strong> : by nature.</p>
<h3 id="clients-data--as4"><a class="header" href="#clients-data--as4">Client's data- AS4</a></h3>
<p>Data sent by the client as part of a request or data about a client processed by the service. This
could appear in logs.</p>
<p><strong>Confidentiality</strong> : some of the client's data could be confidential (example: a buffer to
encrypt).</p>
<p><strong>Integrity</strong> : the data should not be modifiable by attackers. Parsec should be sure that the
source is trusted, and that the client is not being impersonated.</p>
<p><strong>Availability</strong> : the client should be able to access its stored data in a certain amount of time.</p>
<h3 id="configuration-data--as5"><a class="header" href="#configuration-data--as5">Configuration data- AS5</a></h3>
<p>Data stored in the configuration file, read at each reloading of Parsec to instantiate components.</p>
<p><strong>Confidentiality</strong> : the data contains secrets like the user pin of the PKCS 11 device or the owner
hierarchy password of the TPM device.</p>
<p><strong>Integrity</strong> : the data should only be modified by a trusted Parsec administrator.</p>
<p><strong>Availability</strong> : the data should be available when loading or re-loading Parsec.</p>
<h3 id="availability-of-the-service--as6"><a class="header" href="#availability-of-the-service--as6">Availability of the service- AS6</a></h3>
<p>General asset to describe the fact that each client's request should be done in a sane amount of
time. The service should be available at any given point from the moment it is started by the
administrator.</p>
<h3 id="key-identity-mappings--as7"><a class="header" href="#key-identity-mappings--as7">Key Identity Mappings- AS7</a></h3>
<p>Data containing the mapping between a Key Identity (application identity, provider identity, key
name) and the key attributes with a provider-specific identifier of the key. For the Mbed Crypto and
PKCS11 providers this is an ID number, for the TPM provider this is the wrapped key.</p>
<p><strong>Integrity</strong> : Parsec expects this data to be valid.</p>
<p><strong>Availability</strong> : the data should be available when Parsec needs the specific key.</p>
<h3 id="logs--as8"><a class="header" href="#logs--as8">Logs- AS8</a></h3>
<p>Data stored in logs emitted by any component of the stack.</p>
<p><strong>Confidentiality</strong> : the logs can contain confidential information of different parts of the
service.</p>
<p><strong>Integrity</strong> : the integrity of the logs is essential to prove that some events took place in
Parsec.</p>
<p><strong>Availability</strong> : the logs should be available for reading and writing when needed.</p>
<h2 id="attackers"><a class="header" href="#attackers">Attackers</a></h2>
<p>Each dataflow is analysed from an attacker's perspective using STRIDE method. Nothing is supposed on
the different components.</p>
<p>In the following tables are present the type of each possible threat, its description, its
mitigation status and the assets impacted. A threat can be unmitigated (U), mitigated within the
service (M) or mitigated through operational requirements (O). The assumptions context applies for
all threats but when one of them is particularly relevant, it will be noted with ASUM.</p>
<h3 id="attacker-client-request---a1"><a class="header" href="#attacker-client-request---a1">Attacker "Client Request" - A1</a></h3>
<p>This attacker uses the existing Listener endpoint, created by the service, to communicate with it.</p>
<p><em>Not applicable for deployment (DRCT).</em></p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>S</td><td><em>(GNRC, JWTS)</em> An attacker uses another client's authentication token. He can then have access (reference) to any of the impersonated client's keys and execute any operation in their name.</td><td>U-2, O-15</td><td>AS3</td></tr>
<tr><td>S</td><td><em>(GNRC, JWTS)</em> An attacker uses brute-force on the AUTH field of the request until he does not have an AuthenticationError response status to then deduce a valid authentication token.</td><td>M-2</td><td>AS1</td></tr>
<tr><td>S</td><td><em>(DSPC)</em> An attacker uses another client's Unix account. He can then have access (reference) to any of the impersonated client's keys and execute any operation in their name.</td><td>U-5</td><td>AS3</td></tr>
<tr><td>S</td><td><em>(DSPC)</em> An attacker uses a Unix account with the same UID as a client. He can then have access (reference) to any of the impersonated client's keys and execute any operation in their name.</td><td>O-11, ASUM-3</td><td>AS3</td></tr>
<tr><td>S</td><td>An attacker uses a weakness or a bug of the current authenticator to access all keys created with past and present authentication methods.</td><td>O-12, U-6</td><td>AS3</td></tr>
<tr><td>T</td><td>An attacker modifies the valid request of another client to modify the operation and make it non-secure.</td><td>M-3</td><td>AS4</td></tr>
<tr><td>R</td><td>A client denies the authorship of a request.</td><td>U-7</td><td></td></tr>
<tr><td>I</td><td>An attacker can read the confidential information of a request from another client.</td><td>M-3</td><td>AS1, AS4</td></tr>
<tr><td>I</td><td><em>(GNRC, JWTS)</em> An attacker steals the authentication token from a client's request to then execute any operation in their name.</td><td>M-3</td><td>AS4, AS3</td></tr>
<tr><td>D</td><td>An attacker modifies the valid request of another client to modify the operation and make it fail.</td><td>M-3</td><td>AS6</td></tr>
<tr><td>D</td><td>An attacker overloads/crashes the system and thus prevents any other user from making use of the service.</td><td>Crashes: M-0, M-5 Overloads: U-0</td><td>AS6</td></tr>
<tr><td>E</td><td>A malicious request, formatted in a specific way, triggers remote code execution in Parsec privilege level.</td><td>U-3, M-10, M-5</td><td>All</td></tr>
<tr><td>E</td><td>A malicious request exploits a vulnerability in the software stack and leads to an attacker having Parsec privilege level on key management in the underlying hardware.</td><td>U-3, M-10, M-5</td><td>AS3, AS6</td></tr>
</tbody></table>
</div>
<h3 id="attacker-service-response---a2"><a class="header" href="#attacker-service-response---a2">Attacker "Service Response" - A2</a></h3>
<p>This attacker uses the existing Listener endpoint, created by the service, to communicate with the
client. It can also create a spoofed endpoint, mimicking the service's one.</p>
<p>For protection of the clients' assets, please check the Parsec Clients Threat Models.</p>
<p><em>Not applicable for deployment (DRCT).</em></p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>S</td><td>An attacker impersonates the Parsec service: clients share their data with a malicious entity.</td><td>O-2, O-9</td><td>AS3, AS4, AS6</td></tr>
<tr><td>T</td><td>An attacker modifies the response of another client to change its body or its header and thus alter the type, content or status of the response.</td><td>M-3</td><td>AS4</td></tr>
<tr><td>R</td><td>A client denies that the response was indeed sent by the Parsec service.</td><td>O-2, U-7, O-9</td><td></td></tr>
<tr><td>I</td><td>An attacker can read the content of a response.</td><td>M-3</td><td>AS4</td></tr>
<tr><td>I</td><td>The response code of a request gives too much information about the way the data is processed by the service that an attacker can use for an attack.</td><td>M-1</td><td>Depends on the attack</td></tr>
<tr><td>D</td><td>An attacker modifies the valid response of another client to pretend it failed or succeeded.</td><td>M-3</td><td>AS6</td></tr>
<tr><td>D</td><td>An attacker modifies the response in such a way that it leads the client to crash.</td><td>M-3</td><td></td></tr>
<tr><td>E</td><td>An attacker modifies the response in such a way that it leads to code execution in the client sandbox at the same level as the client.</td><td>M-3</td><td></td></tr>
</tbody></table>
</div>
<h3 id="attacker-os-signal---a3"><a class="header" href="#attacker-os-signal---a3">Attacker "OS Signal" - A3</a></h3>
<p>This attacker has the capability of sending signals to the Parsec process. For example, on a Linux
machine a <code>SIGINT</code> signal.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>S</td><td>N/A</td><td></td><td></td></tr>
<tr><td>T</td><td>A <code>SIGHUP</code> is modified by an attacker into <code>SIGTERM</code> or the other way around.</td><td>ASUM-3</td><td>AS6</td></tr>
<tr><td>R</td><td>N/A</td><td></td><td></td></tr>
<tr><td>I</td><td>N/A</td><td></td><td></td></tr>
<tr><td>D</td><td>An attacker can kill the Parsec service, gracefully or not or trigger an infinite loop of configuration reloads.</td><td>O-0</td><td>AS6</td></tr>
<tr><td>E</td><td>N/A</td><td></td><td></td></tr>
</tbody></table>
</div>
<h3 id="attacker-service-operation---a4"><a class="header" href="#attacker-service-operation---a4">Attacker "Service Operation" - A4</a></h3>
<p>This attacker communicates with the security hardware on the platform using the operating system
interfaces.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>S</td><td>An attacker directly drives the platform hardware to execute commands on it.</td><td>O-8</td><td>AS3, AS6</td></tr>
<tr><td>T</td><td>An attacker modifies the commands sent to hardware modules.</td><td>O-8, U-3, M-10</td><td>AS3, AS6</td></tr>
<tr><td>R</td><td>Commands cannot be proven to have originated in the service.</td><td>U-7</td><td></td></tr>
<tr><td>I</td><td>An attacker can read the content of commands to the hardware.</td><td>O-8, U-3, M-10</td><td>AS3, AS4, AS5</td></tr>
<tr><td>D</td><td>An attacker modifies the commands sent to the hardware to make them fail.</td><td>O-8, U-3, M-10</td><td>AS6</td></tr>
<tr><td>D</td><td>Attacker causes the underlying hardware to fail or be generally unusable.</td><td>O-8, U-3, M-10</td><td>AS6</td></tr>
<tr><td>D</td><td>Attacker disrupts the software stack that drives the hardware (e.g. replaces or removes PKCS 11 dynamic libraries).</td><td>O-8, U-3, M-10</td><td>AS6</td></tr>
<tr><td>E</td><td>An attacker uses the configured state of a hardware module to make operations with a higher privilege on it.</td><td>O-8, U-3, M-10, U-4</td><td>AS3, AS6</td></tr>
</tbody></table>
</div>
<h3 id="attacker-hardware-result---a5"><a class="header" href="#attacker-hardware-result---a5">Attacker "Hardware Result" - A5</a></h3>
<p>This attacker communicates with the service using the operating system interfaces for hardware. It
can also create a spoofed hardware interface.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>S</td><td>An attacker impersonates a hardware module or uses a malicious module plugged to the machine.</td><td>O-1, ASUM-1</td><td>AS4, AS6, AS7</td></tr>
<tr><td>T</td><td>An attacker modifies the response of a hardware command.</td><td>O-8, U-3, M-10</td><td>AS4, AS6</td></tr>
<tr><td>R</td><td>Responses cannot be proven to originate from the hardware module.</td><td>U-7</td><td></td></tr>
<tr><td>I</td><td>An attacker can read the content of a command response.</td><td>U-3, M-10, O-8</td><td>AS3, AS4, AS5</td></tr>
<tr><td>D</td><td>An attacker modifies the valid command response to pretend it failed or succeeded.</td><td>U-3, M-10, O-8</td><td>AS6</td></tr>
<tr><td>E</td><td>A malicious command response, formatted in a specific way, triggers remote code execution in Parsec privilege level.</td><td>U-3, M-10, M-5, O-8</td><td>All</td></tr>
</tbody></table>
</div>
<h3 id="attacker-key-mapping-storage---a6"><a class="header" href="#attacker-key-mapping-storage---a6">Attacker "Key Mapping Storage" - A6</a></h3>
<p>Attacker with access to the key info mapping stream generated by Key Info Managers when storing its
data and to the persistent storage mechanism used for this purpose.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>S</td><td>An attacker stores spoofed key handles/material, e.g. allowing themselves to access keys they should not have access to.</td><td>O-3</td><td>AS3, AS6</td></tr>
<tr><td>T</td><td>An attacker modifies the data stored for a mapping to either divert another user to use a different key, or to allow himself access to some key.</td><td>O-3</td><td>AS3, AS6</td></tr>
<tr><td>R</td><td>The mappings cannot be proven to have been generated by the service.</td><td>U-7</td><td></td></tr>
<tr><td>I</td><td>Key handles could be leaked and thus used to access keys through other means.</td><td>O-3</td><td>AS3,AS4</td></tr>
<tr><td>D</td><td>An attacker could prevent the storage to be completed, e.g. by filling up the disk and running into space-related issues.</td><td>O-4</td><td>AS6</td></tr>
<tr><td>E</td><td>N/A</td><td></td><td></td></tr>
</tbody></table>
</div>
<h3 id="attacker-key-mapping-retrieval---a7"><a class="header" href="#attacker-key-mapping-retrieval---a7">Attacker "Key Mapping Retrieval" - A7</a></h3>
<p>Attacker with access to the data stream returning to the Key Info Manager from its source of
persistent storage.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>S</td><td>Attacker spoofs the existence of a mapping and makes the service use an incorrect or invalid key (handle).</td><td>M-6, O-3</td><td>AS3, AS4, AS6</td></tr>
<tr><td>T</td><td>An attacker alters the retrieval of stored material to change the key that is used for an operation initiated by either himself or some other user.</td><td>M-6</td><td>AS3, AS6</td></tr>
<tr><td>R</td><td>There is no way to guarantee that the mapping being retrieved was previously stored by the service.</td><td>U-7</td><td></td></tr>
<tr><td>I</td><td>An attacker can read the mapping in transit.</td><td>M-6</td><td>AS3</td></tr>
<tr><td>D</td><td>An attacker prevents the value from being read.</td><td>M-6</td><td>AS6</td></tr>
<tr><td>D</td><td>An attacker removes all stored values, preventing users from utilizing their keys.</td><td>O-3</td><td>AS6</td></tr>
<tr><td>D</td><td>A malicious key handle, formatted in a specific way, leads to a service crash.</td><td>O-3, M-5, U-3, M-10</td><td>AS6</td></tr>
<tr><td>E</td><td>A malicious key handle, formatted in a specific way, triggers remote code execution in Parsec privilege level.</td><td>O-3, M-5, U-3, M-10</td><td>All</td></tr>
</tbody></table>
</div>
<h3 id="attacker-logging---a8"><a class="header" href="#attacker-logging---a8">Attacker "Logging" - A8</a></h3>
<p>Attacker with access to the log stream generated by the Parsec service and to the log file.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>S</td><td>An attacker could write to the log file, pretending to be the Parsec service and dilute the true logs, potentially hiding errors or crashes.</td><td>O-5</td><td>AS6</td></tr>
<tr><td>S</td><td>An attacker uses the same logging façade mechanism to write on the logs from a malicious Parsec dependency.</td><td>M-7</td><td>AS6</td></tr>
<tr><td>T</td><td>Attacker can modify logs to hide/modify details about crashes, errors or any other suspicious activity.</td><td>O-5</td><td>AS6</td></tr>
<tr><td>T</td><td>An attacker can delete the log file, removing all evidence of previous activity.</td><td>O-5</td><td>AS6</td></tr>
<tr><td>R</td><td>There is no guarantee about the true origin of log messages.</td><td>O-5</td><td></td></tr>
<tr><td>I</td><td>Log messages can be read by an adversary and their contents can disclose information about the activity of other users.</td><td>O-5</td><td>AS1, AS4, AS5</td></tr>
<tr><td>D</td><td>An attacker prevents access to the logging system by the service putting it in a stall state or triggering errors/crashes.</td><td>O-5, O-4</td><td>AS6</td></tr>
<tr><td>E</td><td>N/A</td><td></td><td></td></tr>
</tbody></table>
</div>
<h3 id="attacker-configuration---a9"><a class="header" href="#attacker-configuration---a9">Attacker "Configuration" - A9</a></h3>
<p>Attacker with access to the configuration file for the Parsec service or to the OS-provided
mechanism for reading it.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>S</td><td>An adversary can spoof a configuration file, leading to the service operating in an unsecure state, ineffective state or not starting at all.</td><td>O-6</td><td>AS3, AS5, AS6</td></tr>
<tr><td>T</td><td>The configuration file set up by the administrator might be modified, leading to the service being unsecure, ineffective or broken.</td><td>O-6</td><td>AS3, AS5, AS6</td></tr>
<tr><td>R</td><td>There are no guarantees that the person setting up the configuration file was authorised to do so.</td><td>O-6</td><td></td></tr>
<tr><td>I</td><td>The configuration file might, if read by an adversary, provide information that opens different attack avenues.</td><td>O-6</td><td>AS5</td></tr>
<tr><td>I</td><td>If the configuration file is tampered, information about the existing keys can be extracted through rogue providers.</td><td>O-6</td><td>AS5</td></tr>
<tr><td>D</td><td>Removing or altering the configuration file can lead to the Parsec service not starting or working in a broken state.</td><td>O-6</td><td>AS6</td></tr>
<tr><td>E</td><td>Parsing a malicious configuration file can lead to code execution at the Parsec privilege level.</td><td>M-5, U-3, M-10, O-6</td><td>All</td></tr>
</tbody></table>
</div>
<h3 id="attacker-identity-provider---a10"><a class="header" href="#attacker-identity-provider---a10">Attacker "Identity Provider" - A10</a></h3>
<p>Attacker with access to the communication running from the Identity Provider to the Parsec service.</p>
<p><em>Not applicable for deployment (DRCT). For deployment (DSPC) the operating system is considered
sufficiently secure, as described in assumption 3.</em></p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>S</td><td>The initial trust bundle can be spoofed, and an attacker can thus gain complete control over the service.</td><td>O-7</td><td>AS2 and then all</td></tr>
<tr><td>T</td><td>The trust bundle shared by the identity provider can be modified in transit to disrupt the operation of the service or take control of it.</td><td>M-3</td><td>AS2 and then all</td></tr>
<tr><td>R</td><td>The service cannot guarantee that the trust bundle it received comes from the trusted identity provider.</td><td>O-7</td><td></td></tr>
<tr><td>I</td><td>N/A - the trust bundle contains public information</td><td></td><td></td></tr>
<tr><td>D</td><td>If the communication path between identity provider and service is disrupted, the service will not be in a fully functional state as it will not be able to authenticate requests.</td><td>M-3</td><td>AS2, AS6</td></tr>
<tr><td>D</td><td>A malicious share bundle could trigger a parsing bug and lead the service to crash.</td><td>M-5, U-3, M-10</td><td>AS2, AS6</td></tr>
<tr><td>E</td><td>A malicious share bundle could trigger a parsing bug and lead to code execution at the Parsec privilege level.</td><td>M-5, U-3, M-10</td><td>All</td></tr>
</tbody></table>
</div>
<h3 id="attacker-local-memory---a11"><a class="header" href="#attacker-local-memory---a11">Attacker "Local Memory" - A11</a></h3>
<p>Attacker with access to the local memory regions used by Parsec. This attacker can be another
process scheduled by the OS in the same timeframe than Parsec and reading the memory which was not
cleared.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>I</td><td>The attacker can read all the confidential assets placed in local memory by the service.</td><td>M-8</td><td>AS1, AS2, AS4 and AS5</td></tr>
</tbody></table>
</div>
<h3 id="attacker-spiffe-validation-request---a12"><a class="header" href="#attacker-spiffe-validation-request---a12">Attacker "SPIFFE Validation Request" - A12</a></h3>
<p>This attacker uses the SPIFFE Workload API endpoint created by the SPIFFE implementation to
interfere with the validation of the JWT-SVID token sent by the client.</p>
<p><em>Only applicable for deployment (JWTS).</em></p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>I</td><td>An attacker steals the authentication token from a client's request to then execute any operation in their name.</td><td>M-9</td><td>AS4, AS3</td></tr>
<tr><td>D</td><td>An attacker modifies the validation request to make it fail.</td><td>M-9</td><td>AS6</td></tr>
<tr><td>D</td><td>An attacker overloads/crashes the SPIFFE implementation and thus prevents the service from making use of it.</td><td>SPIFFE implementation specific. An <a href="https://github.com/spiffe/spiffe/blob/master/standards/SPIFFE_Workload_Endpoint.md#6-error-codes">"Unavailable" error</a> can be used for implementations to perform load-shedding.</td><td>AS6</td></tr>
</tbody></table>
</div>
<h3 id="attacker-spiffe-validation-response---a13"><a class="header" href="#attacker-spiffe-validation-response---a13">Attacker "SPIFFE Validation Response" - A13</a></h3>
<p>This attacker uses the SPIFFE Workload API endpoint created by the SPIFFE implementation to
interfere with the validation of the JWT-SVID token sent by the client. It can also create a spoofed
endpoint, mimicking the SPIFFE implementation's one.</p>
<p><em>Only applicable for deployment (JWTS).</em></p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Description</th><th>Mitigation</th><th>Assets</th></tr></thead><tbody>
<tr><td>S</td><td>An attacker impersonates the SPIFFE implementation: Parsec sends the authentication data of clients to malicious entity.</td><td>O-14</td><td>AS1</td></tr>
<tr><td>T</td><td>An attacker modifies the validation response of the SPIFFE implementation to yield the application identity of its choice.</td><td>O-14</td><td>AS1</td></tr>
<tr><td>D</td><td>An attacker modifies the validation response to pretend it failed or succeeded.</td><td>M-9</td><td>AS6</td></tr>
<tr><td>D</td><td>An attacker modifies the validation response in such a way that it leads the service to crash.</td><td>M-9</td><td>AS6</td></tr>
<tr><td>E</td><td>An attacker modifies the validation response in such a way that it leads to code execution at the service privilege level.</td><td>M-9</td><td>AS4, AS5, AS6, AS7, AS8</td></tr>
</tbody></table>
</div>
<h2 id="unmitigations"><a class="header" href="#unmitigations">Unmitigations</a></h2>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Justification</th><th>Consequences</th></tr></thead><tbody>
<tr><td>0</td><td>An attacker can use all the threads of the service's thread pool, requesting for a time-consuming operation on each one of them, to leave the less amount of free time possible to other clients.</td><td>The requests take more time to execute.</td></tr>
<tr><td>2</td><td>The authentication token is stored with confidentiality by the clients. If it is stolen, the service cannot prevent access with it unless the token is revoked.</td><td>All the client's keys can be used, and exported if allowed by the key's policy.</td></tr>
<tr><td>3</td><td>Parsec dependencies are not (visually) investigated for Security Vulnerabilities. (See M-10 for our mitigation.)</td><td>A vulnerability in one of Parsec dependency will also impact Parsec and the data Parsec shares with that dependency.</td></tr>
<tr><td>4</td><td>While Parsec is authenticated on the device, anyone can brute force a key ID to execute operations with the key. Unmitigated for the PKCS 11 Provider: all sessions share the login state; if one session logs in then all other opened sessions will also be logged in. Other sessions only need a valid key ID to execute operations with private keys. Mitigated for the TPM Provider: each key is protected by a long, random authentication value, generated by the TPM</td><td>All the client's PKCS 11 keys can be used with PKCS 11 operations.</td></tr>
<tr><td>5</td><td><em>(DSPC)</em> Parsec does not know about the security quality of a client's Unix password.</td><td>All the client's keys can be used, and exported if allowed by the key's policy.</td></tr>
<tr><td>6</td><td>Parsec does not support using multiple authenticators concurrently (<a href="https://github.com/parallaxsecond/parsec/issues/272">open issue</a>).</td><td>If there is weakness in one authenticator, all the client's keys can be used, and exported if allowed by the key's policy.</td></tr>
<tr><td>7</td><td>Parsec does not protect from some of the repudiation threats. Logging is used as best-effort way throughout the codebase to note the identity, time and date of important events such as: "new request received", "response sent back", "new mapping created", "mapping is read from the persistent store", "a hardware command is issued" and "a hardware command is received".</td><td>There might be no proof that some event took place. See <a href="https://github.com/parallaxsecond/parsec-book/issues/84">this issue</a>.</td></tr>
</tbody></table>
</div>
<h2 id="mitigations"><a class="header" href="#mitigations">Mitigations</a></h2>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Justification</th><th>Details</th></tr></thead><tbody>
<tr><td>0</td><td>Parsec uses a thread pool with a configurable amount of threads to limit the number of concurrent operations it can support so that the machine is not overloaded.</td><td><a href="https://github.com/parallaxsecond/parsec/commit/e87984c4d3eaafa1a1cb977dceadf773aca1f7db">Done</a></td></tr>
<tr><td>1</td><td>Response statuses are audited to not give too much information to the client.</td><td><a href="https://github.com/parallaxsecond/parsec-interface-rs/issues/59">Done</a></td></tr>
<tr><td>2</td><td><em>(not DRCT)</em> The authenticators should only allow authentication tokens that are secure enough that brute-force attacks are not feasible.</td><td><em>(JWTS)</em> The <a href="https://github.com/spiffe/spiffe/blob/master/standards/JWT-SVID.md#21-algorithm">algorithms</a> prescribed by the JWT-SVID standard are secure enough to prevent brute-force attacks in most cases.</td></tr>
<tr><td>3</td><td>Listener implementations use an IPC mechanism respecting confidentiality and integrity of messages transmitted between the clients and the service (once the initial connection has been made).</td><td>Unix Domain Socket Listener: the sockets used on the client and service side for the communication are represented by file descriptors that are only accessible by those processes.</td></tr>
<tr><td>5</td><td>Parsec is coded with safety in mind and is tested extensively.</td><td><a href="https://github.com/parallaxsecond/parsec-book/issues/35">Done</a></td></tr>
<tr><td>6</td><td>The <code>ManageKeyInfo</code> implementations communicate with its persistence storage backend through a mechanism respecting confidentiality, integrity and availability.</td><td>On-Disk Key Info Manager: the mappings are stored on-disk using the filesystem provided by the OS. OS file permissions are used.</td></tr>
<tr><td>7</td><td>Logging is configured to include the software component from where logs are generated.</td><td><a href="https://github.com/parallaxsecond/parsec/commit/aafd176b49dd01c3f08866d564f2fff092d1305e">Done</a></td></tr>
<tr><td>8</td><td>Sensitive data that was found in the Parsec service memory is cleared once the buffer holding it is no longer used.</td><td><a href="https://github.com/parallaxsecond/parsec/pull/239">Done</a></td></tr>
<tr><td>9</td><td><em>(JWTS)</em> The SPIFFE Workload API endpoint is accessed through an IPC mechanism respecting confidentiality and integrity of messages transmitted between the workloads and the SPIFFE implementation.</td><td>The <a href="https://github.com/spiffe/spiffe/blob/master/standards/SPIFFE_Workload_Endpoint.md#3-transport">SPIFFE Workload Endpoint document</a> prescribes the use of Unix Domain Socket or TCP with strong authentication.</td></tr>
<tr><td>10</td><td>Any vulnerabilities relating to our Rust dependencies which get added to the <a href="https://rustsec.org/">Rust Security Advisory Database</a> get reported on a nightly basis by the CI.</td><td>The <a href="https://github.com/parallaxsecond/parsec/blob/main/SECURITY.md">Parsec Security Policy</a> describes the process we follow to identify and report these to users.</td></tr>
</tbody></table>
</div>
<h2 id="operational-mitigations"><a class="header" href="#operational-mitigations">Operational mitigations</a></h2>
<p>Most of these operational mitigations are implemented when following the <a href="../secure_deployment.html">Recommendations on a
Secure Parsec Deployment guide</a>.</p>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Justification</th><th>Details</th></tr></thead><tbody>
<tr><td>0</td><td>A trusted administrator should start the service in such a way that un-privileged processes cannot send signals to the service.</td><td>In a Unix OS, using a separate user to run the service prevents that.</td></tr>
<tr><td>1</td><td>A trusted administrator should check the validity of the providers and hardware modules written in the service's configuration before starting/reloading it.</td><td>This is a manual step that has to be done as part of configuring the service.</td></tr>
<tr><td>2</td><td>Clients need to know from a trusted source that a trusted Parsec service is running on their machine so that they can trust the Listener endpoint.</td><td>The endpoint folder is in a location that only the trusted privileged administrator could have created so clients can trust the existance of a Parsec service.</td></tr>
<tr><td>3</td><td>Mappings should be put in a location that only the Parsec service and the trusted administrator can access.</td><td>The mappings are inside a folder for which the Parsec user should have exclusive access.</td></tr>
<tr><td>4</td><td>The trusted administrator needs to be notified when any kind of resource is running out.</td><td>Currently only the logs can be used as a way of knowing that the system is failing because a resource is running out.</td></tr>
<tr><td>5</td><td>Parsec logs coming from the service binary should be redirected to a file that is only writable by the service and readable by the trusted administrator.</td><td>Using systemd, the logs can only be written by the service and read by the Parsec user. Otherwise, they can be stored in the Parsec user home folder.</td></tr>
<tr><td>6</td><td>Parsec configuration file should be only writable by the trusted administrator and readable by the service.</td><td>The configuration is in a folder configured to be readable only by the Parsec user.</td></tr>
<tr><td>7</td><td><em>(GNRC)</em> The trusted administrator needs to check that during the boot process the trusted identity provider has successfully given the root trust bundle to the service.</td><td>This is a manual check. It is possible that Parsec would not initialize correctly if the root trust bundle has not been given to it.</td></tr>
<tr><td>8</td><td>The hardware descriptors should only be accessible by trusted privileged processes.</td><td>Manual check but this should be the default on most systems.</td></tr>
<tr><td>9</td><td>The Listener endpoint is contained in a location that only the Parsec service and the trusted administrator can access (only they can create the endpoint).</td><td>The endpoint folder is owned by the Parsec user and only writable by them.</td></tr>
<tr><td>10</td><td><em>(DRCT)</em> A set of mutually trusted clients has restricted read-write access to the service IPC endpoint.</td><td>A Parsec Clients Unix group needs to be created for it to exclusively have read-access on the socket.</td></tr>
<tr><td>11</td><td><em>(DSPC)</em> Before a client's Unix account is deleted, all of its Parsec keys must be deleted as well.</td><td>The OS might recycle the same UID previously used by a deleted user and give it to an attacker's account.</td></tr>
<tr><td>12</td><td>The administrator should not change Parsec authentication method while it is currently storing keys.</td><td>The keys are not namespaced with authentication type which means the authentication is as strong as the weakest used.</td></tr>
<tr><td>13</td><td><em>(JWTS)</em> A short expiration time should be set on the JWT-SVID token so that if it is stolen, it can only be used temporarily by attackers.</td><td>The way to set the expiration time of JWT-SVID tokens is implementation-specific. The administrator should ensure it is not too long.</td></tr>
<tr><td>14</td><td><em>(JWTS)</em> The SPIFFE Workload API endpoint must exist before Parsec is started and owned by an independant user. It must not be deleted while Parsec is running.</td><td>It must not be possible for an attacker to put their own socket where the Parsec service and clients expect it. Doing a local validation of the JWT-SVID would remove the need for this mitigation. See <a href="https://github.com/parallaxsecond/parsec/issues/289">here</a> for details.</td></tr>
<tr><td>15</td><td><em>(JWTS)</em> The Parsec clients must be registered as SPIFFE workloads with unique SPIFFE ID.</td><td>Two Parsec clients should not be assigned the same SPIFFE ID.</td></tr>
</tbody></table>
</div>
<p><em>Copyright 2020 Contributors to the Parsec project.</em></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../parsec_security/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../parsec_security/secure_deployment.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../parsec_security/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../parsec_security/secure_deployment.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
